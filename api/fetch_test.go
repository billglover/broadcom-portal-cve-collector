package api

import (
	"os"
	"testing"
	"github.com/stretchr/testify/assert"
)

func TestFetch(t *testing.T) {
	cookie, _ := os.LookupEnv("BC_COOKIE")
	resp, err := Fetch(cookie)
	assert.Nil(t, err)
	assert.GreaterOrEqual(t, len(resp), 9)
	assert.GreaterOrEqual(t, len(resp["Tanzu"]), 50)
}

func TestWorkingCookie(t *testing.T) {
	cookie, _ := os.LookupEnv("BC_COOKIE")
	// err := connectionTest("this is not a cookie!")
	err := connectionTest(cookie)
	assert.Nil(t, err)
}
func TestBrokenCookie(t *testing.T) {
	err := connectionTest("this is not a cookie!")
	assert.Equal(t, err, ErrorInvalidCookie)
}

// func TestBrokenCookie(t *testing.T) {
// 	resp, err := Fetch("this is not a cookie!")
// 	assert.NotNil(t, err)
// 	assert.Nil(t, resp)
// }